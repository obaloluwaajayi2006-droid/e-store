<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Settings â€” Dashboard</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
  <link rel="stylesheet" href="../style.css">
</head>

<body>
  <div class="page-root d-flex">
    <aside class="sidebar bg-light p-4 d-none d-md-block">
      <div class="brand mb-4 d-flex align-items-center gap-2">
      <div class="logo-mark">E</div>
        <h4 class="m-0 fs-4"><a href="../../index.html" class="brand-link">E-store</a></h4>
      </div>
      <nav class="mb-3">
        <ul class="list-unstyled small">
          <li class="py-2"><a href="../index.html" style="text-decoration: none; color: black;">Dashboard</a></li>
          <li class="py-2"><a href="../sales/index.html" style="text-decoration: none; color: black;">Sales</a></li>
          <li class="py-2"><a href="../inventory/index.html" style="text-decoration: none; color: black;">Inventory</a>
          </li>
          <li class="py-2"><a href="../customers/index.html" style="text-decoration: none; color: black;">Customers</a>
          </li>
          <li class="py-2"><a href="../reports/index.html" style="text-decoration: none; color: black;">Reports</a></li>
          <li class="py-2 active"><a href="index.html" style="text-decoration: none; color: black;">Settings</a></li>
        </ul>
      </nav>
    </aside>
    <main class="content flex-fill">
      <header class="topbar d-flex align-items-center justify-content-between p-3 border-bottom">
        <div class="d-flex align-items-center gap-3">
          <button class="btn btn-outline-secondary d-md-none" data-bs-toggle="offcanvas" data-bs-target="#mobileSidebar"
            aria-controls="mobileSidebar">
            <i class="bi bi-list"></i>
          </button>
          <div class="logo d-flex align-items-center gap-2">
            <h4 class="m-0">Settings</h4>
          </div>
        </div>
        <div class="d-flex align-items-center gap-2">
          <div class="me-3 text-end small text-muted">Welcome, <strong id="ownerLabel">Admin</strong></div>
          <a href="../profile/index.html"
            class="avatar rounded-circle bg-primary text-white d-flex align-items-center justify-content-center"
            id="avatarBtn">S</a>
        </div>
      </header>
      <section class="container-fluid p-4">
        <div class="row g-3">
          <div class="col-12 col-md-6">
            <div class="card p-3">
              <h6>Account</h6>
              <form id="accountForm">
                <div class="mb-2"><label class="form-label small">Name</label><input id="nameInput"
                    class="form-control form-control-sm" value="Admin"></div>
                <div class="mb-2"><label class="form-label small">Email</label><input id="emailInput"
                    class="form-control form-control-sm" value="admin@example.com"></div>
                <button type="button" id="saveAccountBtn" class="btn btn-primary btn-sm">Save</button>
              </form>
            </div>
          </div>
          <div class="col-12 col-md-6">
            <div class="card p-3 mb-3" id="profileCard">
              <h6>Profile</h6>
              <div class="small text-muted mb-2">Name: <strong id="profileName">Admin</strong></div>
              <div class="small text-muted mb-2">Email: <strong id="profileEmail">admin@example.com</strong></div>
              <div class="small text-muted mb-2">Total Balance: <strong id="profileBalance">$0.00</strong></div>
              <div class="d-flex gap-2">
                <a href="../profile/index.html" class="btn btn-sm btn-primary">Edit Profile</a>
                <button id="copyBalanceBtn" class="btn btn-outline-secondary btn-sm">Copy Balance</button>
              </div>
            </div>
            <div class="card p-3">
              <h6>Security</h6>
              <p class="small text-muted">Manage your account security and logout.</p>
              <button onclick="signOutBtn()" class="btn btn-outline-danger">Logout</button>
            </div>
          </div>
        </div>
      </section>
    </main>
  </div>
  <!-- Mobile offcanvas sidebar -->
  <div class="offcanvas offcanvas-start" tabindex="-1" id="mobileSidebar" aria-labelledby="mobileSidebarLabel">
    <div class="offcanvas-header ms-auto">
      <!-- <h5 class="offcanvas-title" id="mobileSidebarLabel">E-store</h5> -->
      <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div>
    <div class="offcanvas-body">
      <div class="brand mb-3 d-flex align-items-center gap-2">
      <div class="logo-mark">E</div>
        <h5 class="m-0"><a href="../../index.html" class="brand-link">E-store</a></h5>
      </div>
      <nav class="mb-3">
        <ul class="list-unstyled small">
          <li class="py-2"><a href="../index.html" style="text-decoration: none; color: black;">Dashboard</a></li>
          <li class="py-2"><a href="../sales/index.html" style="text-decoration: none; color: black;">Sales</a></li>
          <li class="py-2"><a href="../inventory/index.html" style="text-decoration: none; color: black;">Inventory</a>
          </li>
          <li class="py-2"><a href="../customers/index.html" style="text-decoration: none; color: black;">Customers</a>
          </li>
          <li class="py-2"><a href="../reports/index.html" style="text-decoration: none; color: black;">Reports</a></li>
          <li class="py-2 active"><a href="index.html" style="text-decoration: none; color: black;">Settings</a></li>
        </ul>
      </nav>
    </div>
  </div>
</body>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
  import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-auth.js";

  const firebaseConfig = {
    apiKey: "AIzaSyD7RJNXJvCyxJW59ge_30HcpDQrS3SGYCQ",
    authDomain: "e-store-project-24928.firebaseapp.com",
    projectId: "e-store-project-24928",
    storageBucket: "e-store-project-24928.firebasestorage.app",
    messagingSenderId: "108352256578",
    appId: "1:108352256578:web:9abfa1487e033c09668bdb"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const auth = getAuth();

  onAuthStateChanged(auth, (user) => {
    if (user) {
      console.log(user);
      show.innerHTML += `
        <tr>
          <td><img src="${user.photoURL}" width="100px" style="border-radius: 100%"></td>
          <td>${user.displayName}</td>
          <td>${user.email}</td>
          <td>3</td>
          <td>${user.metadata.creationTime}</td>
        </tr>
      `
    } else {
      setTimeout(() => {
        // window.location.href = './index.html'
      }, 1000)
    }
  });

  const signOutBtn = () => {
    signOut(auth).then(() => {
      console.log('user is signed out');
      setTimeout(() => {
        window.location.href = '/signin/index.html'
      }, 1000)
    }).catch((error) => {
      // An error happened.
    });

  }
  window.signOutBtn = signOutBtn;


  // document.addEventListener('DOMContentLoaded', () => {
  // const profileName = document.getElementById('profileName');
  // const profileEmail = document.getElementById('profileEmail');
  // const profileBalance = document.getElementById('profileBalance');
  // const ownerLabel = document.getElementById('ownerLabel');
  // const nameInput = document.getElementById('nameInput');
  // const emailInput = document.getElementById('emailInput');

  // const storedName = localStorage.getItem('owner_name') || 'Admin';
  // const storedEmail = localStorage.getItem('owner_email') || 'admin@example.com';
  // const rawBal = localStorage.getItem('dashboard_balance');
  // const bal = rawBal ? Number(rawBal) : 0;

  // const fmt = v => '$' + Number(v).toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 });

  // if (profileName) profileName.textContent = storedName;
  // if (profileEmail) profileEmail.textContent = storedEmail;
  // if (profileBalance) profileBalance.textContent = fmt(bal);
  // if (ownerLabel) ownerLabel.textContent = storedName;
  // if (nameInput) nameInput.value = storedName;
  // if (emailInput) emailInput.value = storedEmail;

  // const saveBtn = document.getElementById('saveAccountBtn');
  // if (saveBtn) saveBtn.addEventListener('click', () => {
  // const newName = (nameInput && nameInput.value.trim()) || 'Admin';
  // const newEmail = (emailInput && emailInput.value.trim()) || 'admin@example.com';
  // localStorage.setItem('owner_name', newName);
  // localStorage.setItem('owner_email', newEmail);
  // if (profileName) profileName.textContent = newName;
  // if (profileEmail) profileEmail.textContent = newEmail;
  // if (ownerLabel) ownerLabel.textContent = newName;
  // const old = saveBtn.textContent;
  // saveBtn.textContent = 'Saved';
  // setTimeout(() => saveBtn.textContent = old, 1000);
  // });

  // const copyBtn = document.getElementById('copyBalanceBtn');
  // if (copyBtn) copyBtn.addEventListener('click', async () => {
  // try {
  // await navigator.clipboard.writeText(profileBalance.textContent);
  // const old = copyBtn.textContent;
  // copyBtn.textContent = 'Copied';
  // setTimeout(() => copyBtn.textContent = old, 1000);
  // } catch (e) {
  // alert('Unable to copy');
  // }
  // });
  // });
</script>

</html>